<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  </head>
  <body>
    <div id="myDiv1" style="width:1400px;height:2500px;"></div>
    <script>
      Plotly.d3.csv(
        "https://raw.githubusercontent.com/nbhogal/testJson/master/apps-links.csv",
        function(err, rows) {
          function unpack(rows, keys) {
            return rows.map(function(row) {
              return row[keys];
            });
          }
          var node_label = unpack(rows, "node_label");
          console.log(node_label);

          var node_color = unpack(rows, "node_color");

          //  var node_color = unpack(rows, "color");

          var link_source = unpack(rows, "link_source");

          var link_target = unpack(rows, "link_target");
          // console.log(link_target);
          var link_value = unpack(rows, "value");

          var link_color = unpack(rows, "link_color");
          // console.log(link_value);
          // var link_label = unpack(rows, "link_label");
          // console.log(link_label);

          var data = {
            type: "sankey",
            orientation: "h",

            node: {
              pad: 15,
              thickness: 15,
              line: {
                color: link_color,
                width: 0.5
              },
              label: node_label,
              color: node_color
            },
            link: {
              source: link_source,
              target: link_target,
              value: link_value
            }
          };

          var data = [data];
          console.log(data);
          var layout = {
            title: "Application Context",
            font: {
              size: 10
            }
          };
          Plotly.newPlot("myDiv1", data, layout);
        }
      );
    </script>

    <script>
      /*      Plotly.d3.json(
        "https://raw.githubusercontent.com/plotly/plotly.js/master/test/image/mocks/sankey_energy.json",
        function(fig) {
          var data = {
            type: "sankey",
            orientation: "h",
            domain: {
              x: [0, 1],
              y: [0, 1]
            },
            valueformat: ".0f",
            valuesuffix: "TWh",

            node: {
              pad: 15,
              thickness: 15,
              line: {
                color: "black",
                width: 0.5
              },
              label: fig.data[0].node.label,
              color: fig.data[0].node.color
            },

            link: {
              source: fig.data[0].link.source,
              target: fig.data[0].link.target,
              value: fig.data[0].link.value,
              label: fig.data[0].link.label
            }
          };

          var data = [data];

          var layout = {
            title: "Energy Forecast",
            width: 1118,
            height: 772,
            font: {
              size: 10
            }
          };

          Plotly.newPlot("myDiv1", data, layout);
          console.log(data);
        }
      );
*/
    </script>
  </body>
</html>
